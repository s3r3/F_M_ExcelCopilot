<!-- Excel AI Copilot Add-in -->
<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>F&M Excel AI Copilot</title>

    <!-- Office JavaScript API -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Fluent UI Styles -->
    <link
      rel="stylesheet"
      href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"
    />

    <!-- Custom styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />

    <style>
      body {
        padding: 16px;
      }

      textarea {
        width: 100%;
        height: 80px;
        resize: vertical;
      }

      #chat-history {
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #ccc;
        padding: 8px;
        margin-top: 12px;
        background: #f9f9f9;
      }

      .user-message,
      .ai-message {
        margin-bottom: 14px;
      }

      .copy-btn {
        font-size: 0.8em;
        margin-left: 6px;
        cursor: pointer;
      }

      #selected-preview {
        font-size: 0.9em;
        margin-top: 8px;
        padding: 4px;
        background: #eef;
        border: 1px solid #cce;
      }

      #loading-indicator {
        color: orange;
        font-size: 0.9em;
        margin-top: 6px;
      }

      .ai-message-block {
        white-space: pre;
        font-family: monospace;
        background: #fff;
        border: 1px solid #ccc;
        padding: 6px;
        margin-top: 5px;
        overflow-x: auto;
      }
    </style>
  </head>

  <body class="ms-font-m ms-Fabric">
    <header
      class="ms-bgColor-neutralLighter ms-font-xl"
      style="padding: 8px; display: flex; align-items: center"
    >
      <img width="32" height="32" src="../../assets/Asset 2.png" alt="Excel AI Copilot" />
      <span style="margin-left: 8px">F&M Excel AI Copilot</span>
    </header>

    <section>
      <textarea
        id="input"
        placeholder="Contoh: Buatkan data penjualan baju 10 baris dalam format CSV"
      ></textarea>
      <br />
      <button class="ms-Button" id="send">
        <span class="ms-Button-label">üöÄ Kirim ke AI</span>
      </button>
      <button class="ms-Button" id="preview-selected">
        <span class="ms-Button-label">üîç Lihat Range</span>
      </button>
      <button id="generate-chart" style="margin-top: 10px;">üìä Buat Grafik dari Seleksi</button>

      <div id="status-box" style="display: none"></div>

    </section>

    <div id="loading-indicator" style="display: none">‚è≥ Memproses...</div>
    <div id="error-display" style="color: red; display: none; margin-top: 8px"></div>

    <div id="selected-preview"></div>

    <div id="chat-history"></div>

    <script src="./taskpane.ts"></script>
  </body>
</html>
